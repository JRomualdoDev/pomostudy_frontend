<z-layout class="h-screen flex flex-col">
      <z-header>
        <div class="flex items-center justify-between w-full">
          <div class="font-semibold text-lg flex items-center">
            <img src="pomostudy.svg" alt="Logo" width="32" height="32" />
            <span class="ml-2">PomoStudy</span>
          </div>
          <div class="flex items-center gap-2">
            <button z-button zType="ghost" zSize="sm">
              <i class="icon-search"></i>
            </button>
            <z-button (click)="toggleTheme()" variant="ghost" size="icon" [attr.aria-label]="getCurrentTheme() === 'dark' ? 'Switch to light mode' : 'Switch to dark mode'">
              @if (getCurrentTheme() === 'dark') {
                <svg class="theme-toggle-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="5"/>
                  <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                </svg>
              } @else {
                <svg class="theme-toggle-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                </svg>
              }
            </z-button>
            <button z-button zType="ghost" zSize="sm">
              <i class="icon-bell"></i>
            </button>
            <button z-button zType="ghost" zSize="sm" (click)="logout()" title="Logout">
              <i class="icon-log-out"></i>
            </button>
          </div>
        </div>
      </z-header>
 
      <z-layout class="flex-1 flex min-h-0">
        <z-sidebar [zWidth]="200" class="!p-0 h-full sidebar">
          <nav class="flex flex-col h-full gap-2 p-4">
            <z-sidebar-group>
              <z-sidebar-group-label>Menu</z-sidebar-group-label>
              <button
                z-button
                [zType]="selectedMenu === 'dashboard' ? 'secondary' : 'ghost'"
                class="justify-start w-full"
                (click)="selectMenu('dashboard'); navigate('/dashboard/index')"
              >
                <i class="icon-house mr-2"></i>
                Dashboard
              </button>
              <button
                z-button
                [zType]="selectedMenu === 'daily' ? 'secondary' : 'ghost'"
                class="justify-start w-full"
                (click)="selectMenu('daily'); navigate('/dashboard/daily')"
              >
                <i class="fa fa-sun mr-2"></i>
                Daily
              </button>
              <button
                z-button
                [zType]="selectedMenu === 'task' ? 'secondary' : 'ghost'"
                class="justify-start w-full"
                (click)="selectMenu('task'); navigate('/dashboard/task')"
              >
                <i class="icon-layers mr-2"></i>
                Tasks
              </button>
              <button
                z-button
                [zType]="selectedMenu === 'category' ? 'secondary' : 'ghost'"
                class="justify-start w-full"
                (click)="selectMenu('category'); navigate('/dashboard/category')"
              >
                <i class="icon-users mr-2"></i>
                Categories
              </button>
              <button
                z-button
                [zType]="selectedMenu === 'goals' ? 'secondary' : 'ghost'"
                class="justify-start w-full"
                (click)="selectMenu('goals'); navigate('/dashboard/goals')"
              >
                <i class="icon-calendar mr-2"></i>
                Goals
              </button>
            </z-sidebar-group>
          </nav>
        </z-sidebar>
 
        <z-layout class="flex-1 flex flex-col min-h-0">
          <z-content class="flex-1 overflow-auto min-h-0">
            <div class="space-y-4  p-4">
              <!-- <z-skeleton class="h-170 w-full"></z-skeleton> -->
              <router-outlet class="flex-1 min-h-0"></router-outlet>
            </div>
          </z-content>
 
          <z-footer class="flex-none">
            <div class="flex items-center justify-center w-full text-sm text-muted-foreground">Â© {{ year }} PomoStudy</div>
          </z-footer>
        </z-layout>
      </z-layout>
    </z-layout>

    <style>
      /* Theme variables (light defaults) */
      :root {
        --bg: #f8fafc;
        --surface: #ffffff;
        --header-bg: #ffffff;
        --sidebar-bg: #f1f5f9;
        --card-bg: #ffffff;
        --text: #0f172a;
        --muted: #64748b;
        --accent: #3b82f6;
        --accent-strong: #335ca1;
        --border: #e6eef9;
        --muted-surface: #f3f6fb;
      }

      /* Dark theme: apply when body has class 'dark-theme' or [data-theme="dark"] */
      body.dark-theme,
      .dark-theme,
      [data-theme="dark"] {
        --bg: #071026;
        --surface: #071426;
        --header-bg: #071726;
        --sidebar-bg: #061226;
        --card-bg: #081827;
        --text: #e6eef8;
        --muted: #94a3b8;
        --accent: #60a5fa;
        --accent-strong: #2b6cb0;
        --border: rgba(255,255,255,0.06);
        --muted-surface: rgba(255,255,255,0.02);
      }

      /* Apply general colors */
      html, body, z-layout {
        background: var(--bg) !important;
        color: var(--text) !important;
      }

      z-header,
      z-footer,
      .z-header,
      .z-footer {
        background: var(--header-bg) !important;
        color: var(--text) !important;
        /* border-bottom: 1px solid var(--border); */
      }

      /* Sidebar */
      z-sidebar,
      .sidebar {
        background: var(--sidebar-bg) !important;
        color: var(--text) !important;
        /* border-right: 1px solid var(--border); */
      }
      z-sidebar button[z-button], .sidebar button[z-button] {
        color: var(--text);
      }

      /* Content cards and forms */
      z-content,
      .space-y-4,
      .daily-task-detail,
      .sidebar-create-form,
      .elegant-table {
        background: transparent;
        color: var(--text);
      }

      /* Inputs, selects, popovers, buttons */
      input, textarea, select, z-select, z-button, .z-input {
        background: var(--card-bg) !important;
        color: var(--text) !important;
        border: 1px solid var(--border) !important;
      }

      /* Buttons primary / accent */
      z-button[zType="secondary"], .save-task-btn {
        background: linear-gradient(90deg, var(--accent) 0%, var(--accent-strong) 100%) !important;
        color: #fff !important;
        box-shadow: 0 8px 24px rgba(11,20,40,0.12);
      }
      z-button[zType="ghost"], button[z-button][zType="ghost"] {
        background: transparent !important;
        color: var(--text) !important;
        border: none !important;
      }

      /* Tables */
      .elegant-table {
        width: 100%;
        border-collapse: collapse;
      }
      .elegant-table th, .elegant-table td {
        padding: 10px 12px;
        border-bottom: 1px solid var(--border);
        color: var(--text);
      }
      .elegant-table thead th {
        color: var(--muted);
        font-weight: 600;
        background: transparent;
      }

      /* Sidebar chooser button */
      .choose-cat-btn {
        color: var(--text);
        background: transparent;
        border: 1px solid var(--border);
      }

      /* Popovers / modals */
      z-popover, .z-popover {
        background: var(--card-bg) !important;
        color: var(--text) !important;
        border: 1px solid var(--border) !important;
        box-shadow: 0 12px 40px rgba(2,6,23,0.6);
      }

      /* Muted text (small labels) */
      .text-muted, .text-muted-foreground {
        color: var(--muted) !important;
      }

      /* Ensure icons visible */
      .fa, .icon-search, .icon-bell, .icon-log-out, .icon-house, .fa-sun {
        color: var(--text) !important;
        opacity: 0.95;
      }

      /* Accessibility: focus ring (subtle) for keyboard users */
      .z-button:focus, button:focus, input:focus, select:focus {
        outline: 2px solid rgba(96,165,250,0.18);
        outline-offset: 2px;
      }

      /* central content panel (make not pure white, respect theme) */
      .space-y-4 {
        background: var(--surface) !important;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(2,6,23,0.06);
        border: 1px solid var(--border);
      }

      /* ensure router outlet area uses surface color */
      z-content .space-y-4,
      .page-panel {
        background: var(--surface) !important;
      }

      /* Selected sidebar button: readable in both themes */
      .sidebar button[z-button][zType="secondary"] {
        /* subtle surface highlight and left accent */
        background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)) !important;
        color: var(--text) !important;
        font-weight: 700;
        border-radius: 8px;
        box-shadow: none !important;
        border: 1px solid transparent !important;
        padding-left: 14px;
        position: relative;
      }
      /* left accent strip */
      .sidebar button[z-button][zType="secondary"]::before {
        content: "";
        position: absolute;
        left: 0;
        top: 6px;
        bottom: 6px;
        width: 4px;
        background: var(--accent) ;
        border-radius: 4px;
      }

      /* Dark-theme specific adjustments for selected sidebar button (better contrast) */
      body.dark-theme .sidebar button[z-button][zType="secondary"],
      [data-theme="dark"] .sidebar button[z-button][zType="secondary"],
      .dark-theme .sidebar button[z-button][zType="secondary"] {
        background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)) !important;
        color: var(--text) !important;
        box-shadow: 0 6px 16px rgba(2,6,23,0.35);
      }

      /* Table surfaces in dark mode */
      .elegant-table tbody tr td,
      .elegant-table tbody tr th {
        background: transparent;
        color: var(--text);
      }
      body.dark-theme .elegant-table thead th {
        color: var(--muted);
      }
      /* subtle row highlight consistent with dark theme */
      body.dark-theme .elegant-table tbody tr:hover {
        background: rgba(255,255,255,0.02) !important;
      }

      /* Inputs and form fields: softer in dark */
      input, textarea, select, z-select, .z-input {
        background: var(--card-bg) !important;
        color: var(--text) !important;
        border: 1px solid var(--border) !important;
      }

      /* Keep popovers matching surface */
      z-popover, .z-popover {
        background: var(--card-bg) !important;
        color: var(--text) !important;
        border: 1px solid var(--border) !important;
      }
    </style>